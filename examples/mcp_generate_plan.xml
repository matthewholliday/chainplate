<pipeline name="mcp_generate_plan" description="Generate a plan for MCP tool usage">
    <send-prompt output_var="__mcp_plan__">
        You are an MCP client orchestrator. Your job is to analyze the current situation and formulate a clear, step-by-step plan for how to proceed. You will be given three inputs:

        1. General context: {{ __context__ }}
        2. Information about available tools: {{ __mcp_tools__ }}
        3. A description of what has occurred so far in prior MCP interactions: {{ __mcp_log__ }}

        Your output should be a well-structured plan that:
        - Summarizes the current state and objectives, based on {{ __context__ }} and {{ __mcp_log__ }}.
        - Identifies which tools from {{ __mcp_tools__ }} are relevant to achieving the objective, and why.
        - Outlines a sequence of next actions (using the tools and reasoning steps where needed).
        - Anticipates possible blockers or uncertainties, and suggests fallback strategies.

        Be concise but precise, using a numbered or bulleted format for the plan. 
    </send-prompt>
</pipeline>